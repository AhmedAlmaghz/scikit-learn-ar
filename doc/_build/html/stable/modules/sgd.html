
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="انحدار تدرج الاحتمالية العشوائي" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://scikit-learn/stable/modules/sgd.html" />
<meta property="og:site_name" content="scikit-learn" />
<meta property="og:description" content="انحدار تدرج الاحتمالية العشوائي (SGD) هو نهج بسيط ولكنه فعال للغاية لملاءمة المصنفات والمنقبات الخطية تحت دالات خسارة محدبة مثل (الخطية) Support Vector Machines و Logistic Regression. على الرغم من ..." />
<meta property="og:image" content="https://scikit-learn/stable/_images/sphx_glr_plot_sgd_separating_hyperplane_001.png" />
<meta property="og:image:alt" content="scikit-learn" />
<meta name="description" content="انحدار تدرج الاحتمالية العشوائي (SGD) هو نهج بسيط ولكنه فعال للغاية لملاءمة المصنفات والمنقبات الخطية تحت دالات خسارة محدبة مثل (الخطية) Support Vector Machines و Logistic Regression. على الرغم من ..." />

    <title>انحدار تدرج الاحتمالية العشوائي &#8212; scikit-learn 1.5.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/colors.css?v=cc94ab7d" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/custom.css?v=e4cb1417" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=44dfd65d"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=97f0b27d"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script data-domain="scikit-learn.org" defer="defer" src="https://views.scientific-python.org/js/script.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modules/sgd';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://scikit-learn.org/dev/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.5.1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <script src="../_static/scripts/dropdown.js?v=e2048168"></script>
    <script src="../_static/scripts/version-switcher.js?v=a6dd8357"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/scikit-learn-logo-small.png" class="logo__image only-light" alt="scikit-learn homepage"/>
    <script>document.write(`<img src="../_static/scikit-learn-logo-small.png" class="logo__image only-dark" alt="scikit-learn homepage"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    مرجع المستخدم
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://blog.scikit-learn.org/">
    Community
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../getting_started.html">
    بدء الاستخدام
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../whats_new.html">
    تاريخ الإصدارات
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://scikit-learn.org/dev/developers/index.html">
    Development
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../faq.html">
    FAQ
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../support.html">
    الدعم
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../related_projects.html">
    التعاون مع الأطر الأخرى وتحسينها
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
    خارطة الطريق
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../governance.html">
    Governance
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../about.html">
    الحوكمة
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scikit-learn/scikit-learn" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    مرجع المستخدم
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://blog.scikit-learn.org/">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started.html">
    بدء الاستخدام
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../whats_new.html">
    تاريخ الإصدارات
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scikit-learn.org/dev/developers/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../support.html">
    الدعم
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../related_projects.html">
    التعاون مع الأطر الأخرى وتحسينها
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../roadmap.html">
    خارطة الطريق
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../governance.html">
    Governance
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    الحوكمة
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scikit-learn/scikit-learn" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">انحدار تدرج...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="sgd">
<span id="id1"></span><h1>انحدار تدرج الاحتمالية العشوائي<a class="headerlink" href="#sgd" title="Link to this heading">#</a></h1>
<p><strong>انحدار تدرج الاحتمالية العشوائي (SGD)</strong> هو نهج بسيط ولكنه فعال للغاية
لملاءمة المصنفات والمنقبات الخطية تحت
دالات خسارة محدبة مثل (الخطية) <a class="reference external" href="https://en.wikipedia.org/wiki/Support_vector_machine">Support Vector Machines</a> و <a class="reference external" href="https://en.wikipedia.org/wiki/Logistic_regression">Logistic
Regression</a>.
على الرغم من أن SGD موجود منذ فترة طويلة في مجتمع تعلم الآلة،
إلا أنه حظي مؤخرًا باهتمام كبير في سياق التعلم واسع النطاق.</p>
<p>تم تطبيق SGD بنجاح على مشكلات التعلم الآلي واسعة النطاق والمفرطة
التي يتم مواجهتها غالبًا في تصنيف النصوص ومعالجة اللغات الطبيعية.
ونظرًا لأن البيانات مفرطة، فإن المصنفات في هذا النموذج تتوسع بسهولة
لتشمل مشكلات بها أكثر من 10^5 مثال تدريبي وأكثر من 10^5 خاصية.</p>
<p>وبالحديث الدقيق، فإن SGD هو مجرد تقنية تحسين ولا يتوافق مع عائلة
محددة من نماذج التعلم الآلي. إنها مجرد
<em>طريقة</em> لتدريب نموذج. وغالبًا ما يكون لدى مثيل من <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code> أو
<code class="xref py py-class docutils literal notranslate"><span class="pre">SGDRegressor</span></code> مكافئًا في أداة تقدير
واجهة برمجة التطبيقات scikit-learn، باستخدام تقنية تحسين مختلفة.
على سبيل المثال، يؤدي استخدام <code class="docutils literal notranslate"><span class="pre">SGDClassifier(loss='log_loss')</span></code> إلى الانحدار اللوجستي،
أي نموذج مكافئ لـ <code class="xref py py-class docutils literal notranslate"><span class="pre">LogisticRegression</span></code>
الذي يتم ملاؤه عبر SGD بدلاً من ملؤه بواسطة أحد المحللين الآخرين
في <code class="xref py py-class docutils literal notranslate"><span class="pre">LogisticRegression</span></code>. وبالمثل،
<code class="docutils literal notranslate"><span class="pre">SGDRegressor(loss='squared_error',</span> <span class="pre">penalty='l2')</span></code> و
<code class="xref py py-class docutils literal notranslate"><span class="pre">Ridge</span></code> يحلان نفس مشكلة التحسين، بوسائل مختلفة.</p>
<p>مزايا انحدار تدرج الاحتمالية العشوائي هي:</p>
<ul class="simple">
<li><p>الكفاءة.</p></li>
<li><p>سهولة التنفيذ (الكثير من الفرص لضبط الكود).</p></li>
</ul>
<p>وتشمل عيوب انحدار تدرج الاحتمالية العشوائي ما يلي:</p>
<ul class="simple">
<li><p>يتطلب SGD عددًا من فرط المعلمات مثل معامل التنظيم</p></li>
</ul>
<p>وعدد التكرارات.</p>
<ul class="simple">
<li><p>SGD حساس لمقياس الخاصية.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>تأكد من أنك تقوم بتبديل (خلط) بيانات التدريب الخاصة بك قبل ملاءمة النموذج
أو استخدام <code class="docutils literal notranslate"><span class="pre">shuffle=True</span></code> للخلط بعد كل تكرار (يتم استخدامه بشكل افتراضي).
أيضًا، من الناحية المثالية، يجب توحيد المقاييس باستخدام e.g.
<code class="docutils literal notranslate"><span class="pre">make_pipeline(StandardScaler(),</span> <span class="pre">SGDClassifier())</span></code> (راجع: <span class="xref std std-ref">Pipelines</span>).</p>
</div>
<section id="id2">
<h2>التصنيف<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>تنفذ الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code> روتين تعلم الانحدار التدريجي العشوائي العادي
الذي يدعم دالات الخسارة والعقوبات المختلفة للتصنيف. وفيما يلي حد القرار
لمصنف <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code> تم تدريبه بخسارة المفصل، وهو ما يعادل SVM الخطي.</p>
<figure class="align-center">
<a class="reference external image-reference" href="../auto_examples/linear_model/plot_sgd_separating_hyperplane.html"><img alt="../_images/sphx_glr_plot_sgd_separating_hyperplane_001.png" src="../_images/sphx_glr_plot_sgd_separating_hyperplane_001.png" style="width: 480.0px; height: 360.0px;" />
</a>
</figure>
<p>وكما هو الحال مع المصنفات الأخرى، يجب ملاءمة SGD باستخدام صفيفين: صفيف <code class="docutils literal notranslate"><span class="pre">X</span></code>
بشكل (n_samples، n_features) يحتوي على عينات التدريب، وصفيف y بشكل (n_samples،)
يحتوي على القيم المستهدفة (ملصقات الفئات)
لعينات التدريب:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;hinge&quot;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">SGDClassifier(max_iter=5)</span>
</pre></div>
</div>
<p>بعد الملاءمة، يمكن بعد ذلك استخدام النموذج للتنبؤ بقيم جديدة:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>
<span class="go">array([1])</span>
</pre></div>
</div>
<p>يحدد SGD نموذجًا خطيًا لبيانات التدريب. يحتوي معامل <code class="docutils literal notranslate"><span class="pre">coef_</span></code> على
معلمات النموذج:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">coef_</span>
<span class="go">array([[9.9..., 9.9...]])</span>
</pre></div>
</div>
<p>يحتوي معامل <code class="docutils literal notranslate"><span class="pre">intercept_</span></code> على المقاطعة (المعروفة أيضًا باسم الإزاحة أو الانحياز):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">intercept_</span>
<span class="go">array([-9.9...])</span>
</pre></div>
</div>
<p>ما إذا كان يجب على النموذج استخدام مقاطعة، أي فراغ متحيز،
يتم التحكم فيه بواسطة معامل <code class="docutils literal notranslate"><span class="pre">fit_intercept</span></code>.</p>
<p>تعطي دالة <code class="xref py py-meth docutils literal notranslate"><span class="pre">SGDClassifier.decision_function</span></code> المسافة الموقعة إلى الفراغ
(المحسوبة على أنها جداء داخلي بين المعاملات والعينة المدخلة، بالإضافة إلى المقاطعة):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">decision_function</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>
<span class="go">array([29.6...])</span>
</pre></div>
</div>
<p>يمكن تعيين دالة الخسارة الملموسة عبر معامل <code class="docutils literal notranslate"><span class="pre">loss</span></code>. تدعم الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code>
دالات الخسارة التالية:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">loss=&quot;hinge&quot;</span></code>: (soft-margin) linear Support Vector Machine،</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loss=&quot;modified_huber&quot;</span></code>: smoothed hinge loss،</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loss=&quot;log_loss&quot;</span></code>: logistic regression،</p></li>
<li><p>and all regression losses below. In this case the target is encoded as -1
or 1, and the problem is treated as a regression problem. The predicted
class then correspond to the sign of the predicted target.</p></li>
</ul>
<p>يرجى الرجوع إلى القسم الرياضي أدناه
&lt;sgd_mathematical_formulation&gt; للصيغ.
دالتا الخسارة الأوليتان كسولتان، فهما لا تحدثان تحديثات لمعلمات النموذج
إلا إذا انتهك مثال ما قيد الهامش، مما يجعل التدريب فعالاً للغاية وقد يؤدي إلى
نماذج أكثر ندرة (أي بمعاملات صفرية أكثر)، حتى عند استخدام عقوبة L2.</p>
<p>يتيح استخدام <code class="docutils literal notranslate"><span class="pre">loss=&quot;log_loss&quot;</span></code> أو <code class="docutils literal notranslate"><span class="pre">loss=&quot;modified_huber&quot;</span></code> طريقة
<code class="docutils literal notranslate"><span class="pre">predict_proba</span></code>، والتي تعطي متجهًا من تقديرات الاحتمالية
<span class="math notranslate nohighlight">\(P(y|x)\)</span> لكل عينة <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;log_loss&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span> 
<span class="go">array([[0.00..., 0.99...]])</span>
</pre></div>
</div>
<p>يمكن تعيين العقوبة الملموسة عبر معامل <code class="docutils literal notranslate"><span class="pre">penalty</span></code>.
يدعم SGD العقوبات التالية:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">penalty=&quot;l2&quot;</span></code>: L2 norm penalty on <code class="docutils literal notranslate"><span class="pre">coef_</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">penalty=&quot;l1&quot;</span></code>: L1 norm penalty on <code class="docutils literal notranslate"><span class="pre">coef_</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">penalty=&quot;elasticnet&quot;</span></code>: Convex combination of L2 and L1;
<code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">-</span> <span class="pre">l1_ratio)</span> <span class="pre">*</span> <span class="pre">L2</span> <span class="pre">+</span> <span class="pre">l1_ratio</span> <span class="pre">*</span> <span class="pre">L1</span></code>.</p></li>
</ul>
<p>الإعداد الافتراضي هو <code class="docutils literal notranslate"><span class="pre">penalty=&quot;l2&quot;</span></code>. تؤدي عقوبة L1 إلى حلول نادرة،
مما يؤدي إلى جعل معظم المعاملات صفرية. وتعالج شبكة المطاط بعض أوجه القصور
في عقوبة L1 في وجود سمات شديدة الارتباط. يتحكم معامل <code class="docutils literal notranslate"><span class="pre">l1_ratio</span></code> في
الدمج المحدب للعقوبتين L1 وL2.</p>
<p>تدعم الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code> التصنيف متعدد الفئات عن طريق الجمع
بين مصنفات ثنائية متعددة في مخطط “واحد مقابل الجميع” (OVA). لكل
من الفئات <span class="math notranslate nohighlight">\(K\)</span>، يتم تعلم مصنف ثنائي يميز تلك الفئة عن جميع الفئات الأخرى
<span class="math notranslate nohighlight">\(K-1\)</span>. وفي وقت الاختبار، نحسب درجة الثقة (أي المسافات الموقعة إلى الفراغ)
لكل مصنف ونختار الفئة ذات الثقة الأعلى. توضح الصورة أدناه نهج OVA
على مجموعة بيانات Iris. تمثل الخطوط المتقطعة المصنفات الثلاثة OVA؛
توضح ألوان الخلفية سطح القرار الذي تسببه المصنفات الثلاثة.</p>
<figure class="align-center">
<a class="reference external image-reference" href="../auto_examples/linear_model/plot_sgd_iris.html"><img alt="../_images/sphx_glr_plot_sgd_iris_001.png" src="../_images/sphx_glr_plot_sgd_iris_001.png" style="width: 480.0px; height: 360.0px;" />
</a>
</figure>
<p>في حالة التصنيف متعدد الفئات، يكون <code class="docutils literal notranslate"><span class="pre">coef_</span></code> مصفوفة ثنائية الأبعاد
بشكل (n_classes، n_features) و <code class="docutils literal notranslate"><span class="pre">intercept_</span></code> مصفوفة أحادية البعد
بشكل (n_classes،). يحتوي الصف i-th من <code class="docutils literal notranslate"><span class="pre">coef_</span></code> على
متجه الأوزان لمصنف OVA للفئة i-th؛ يتم فهرسة الفئات بترتيب تصاعدي
(راجع معامل “<a href="#id24"><span class="problematic" id="id25">classes_</span></a>”).
لاحظ أنه، من حيث المبدأ، نظرًا لأنها تسمح بإنشاء نموذج احتمالي،
فإن <code class="docutils literal notranslate"><span class="pre">loss=&quot;log_loss&quot;</span></code> و <code class="docutils literal notranslate"><span class="pre">loss=&quot;modified_huber&quot;</span></code> أكثر ملاءمة
للتصنيف أحادي مقابل الجميع.</p>
<p>تدعم الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code> كلاً من الفئات المرجحة والعينات المرجحة
عبر معلمي الملاءمة <code class="docutils literal notranslate"><span class="pre">class_weight</span></code> و <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code>. راجع
الأمثلة أدناه ووثائق سلسلة طرق <code class="xref py py-meth docutils literal notranslate"><span class="pre">SGDClassifier.fit</span></code> لمزيد من المعلومات.</p>
<p>تدعم الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code> متوسط SGD (ASGD) <a href="#id26"><span class="problematic" id="id3">[#4]_</span></a>. يمكن تمكين المتوسط
بوضع <code class="docutils literal notranslate"><span class="pre">average=True</span></code>. يؤدي ASGD نفس التحديثات مثل
SGD العادي (راجع: <span class="xref std std-ref">sgd_mathematical_formulation</span>)، ولكن بدلاً من استخدام
القيمة الأخيرة للمعاملات كمعامل <code class="docutils literal notranslate"><span class="pre">coef_</span></code> (أي قيم
التحديث الأخير)، يتم تعيين <code class="docutils literal notranslate"><span class="pre">coef_</span></code> بدلاً من ذلك إلى متوسط
قيم المعاملات عبر جميع التحديثات. ويتم الشيء نفسه بالنسبة لمعامل <code class="docutils literal notranslate"><span class="pre">intercept_</span></code>.
عند استخدام ASGD، يمكن أن يكون معدل التعلم أكبر وحتى ثابتًا، مما يؤدي في بعض
مجموعات البيانات إلى تسريع وقت التدريب.</p>
<p>بالنسبة للتصنيف بخسارة لوجستية، هناك متغير آخر من SGD مع استراتيجية
المتوسط متاح بخوارزمية متوسط التدرج العشوائي (SAG)،
متاح كمُحسِّن في <code class="xref py py-class docutils literal notranslate"><span class="pre">LogisticRegression</span></code>.</p>
<p class="rubric">أمثلة</p>
<ul class="simple">
<li><p><a class="reference internal" href="../auto_examples/linear_model/plot_sgd_separating_hyperplane.html#sphx-glr-auto-examples-linear-model-plot-sgd-separating-hyperplane-py"><span class="std std-ref">SGD: Maximum margin separating hyperplane</span></a></p></li>
<li><p><a class="reference internal" href="../auto_examples/linear_model/plot_sgd_iris.html#sphx-glr-auto-examples-linear-model-plot-sgd-iris-py"><span class="std std-ref">Plot multi-class SGD on the iris dataset</span></a></p></li>
<li><p><a class="reference internal" href="../auto_examples/linear_model/plot_sgd_weighted_samples.html#sphx-glr-auto-examples-linear-model-plot-sgd-weighted-samples-py"><span class="std std-ref">SGD: Weighted samples</span></a></p></li>
<li><p><a class="reference internal" href="../auto_examples/linear_model/plot_sgd_comparison.html#sphx-glr-auto-examples-linear-model-plot-sgd-comparison-py"><span class="std std-ref">Comparing various online solvers</span></a></p></li>
<li><p><a class="reference internal" href="../auto_examples/svm/plot_separating_hyperplane_unbalanced.html#sphx-glr-auto-examples-svm-plot-separating-hyperplane-unbalanced-py"><span class="std std-ref">SVM: Separating hyperplane for unbalanced classes</span></a>
(راجع الملاحظة في المثال)</p></li>
</ul>
</section>
<section id="id4">
<h2>الانحدار<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>تنفذ الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDRegressor</span></code> روتين تعلم الانحدار التدريجي العشوائي العادي
الذي يدعم دالات الخسارة والعقوبات المختلفة لملاءمة نماذج الانحدار الخطي.
الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDRegressor</span></code> مناسبة لمشكلات الانحدار التي بها عدد كبير من
عينات التدريب (&gt; 10.000)، وبالنسبة للمشكلات الأخرى، نوصي باستخدام الفئات
<code class="xref py py-class docutils literal notranslate"><span class="pre">Ridge</span></code>، أو <code class="xref py py-class docutils literal notranslate"><span class="pre">Lasso</span></code>، أو <code class="xref py py-class docutils literal notranslate"><span class="pre">ElasticNet</span></code>.</p>
<p>يمكن تعيين دالة الخسارة الملموسة عبر معامل <code class="docutils literal notranslate"><span class="pre">loss</span></code>. تدعم الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDRegressor</span></code>
دالات الخسارة التالية:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">loss=&quot;squared_error&quot;</span></code>: Ordinary least squares،</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loss=&quot;huber&quot;</span></code>: Huber loss for robust regression،</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loss=&quot;epsilon_insensitive&quot;</span></code>: linear Support Vector Regression.</p></li>
</ul>
<p>يرجى الرجوع إلى القسم الرياضي أدناه
&lt;sgd_mathematical_formulation&gt; للصيغ.
يمكن استخدام دالتَي الخسارة Huber وepsilon-insensitive للانحدار القوي.
يجب تحديد عرض المنطقة غير الحساسة عبر معامل <code class="docutils literal notranslate"><span class="pre">epsilon</span></code>. يعتمد هذا المعامل
على مقياس المتغيرات المستهدفة.</p>
<p>يحدد معامل <code class="docutils literal notranslate"><span class="pre">penalty</span></code> طريقة التنظيم التي سيتم استخدامها (راجع
الوصف أعلاه في قسم التصنيف).</p>
<p>تدعم الفئة <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDRegressor</span></code> أيضًا متوسط SGD <a href="#id27"><span class="problematic" id="id5">[#4]_</span></a> (هنا مرة أخرى، راجع
الوصف أعلاه في قسم التصنيف).</p>
<p>بالنسبة للانحدار بخسارة مربعة وعقوبة L2، هناك متغير آخر من SGD مع استراتيجية
المتوسط متاح بخوارزمية متوسط التدرج العشوائي (SAG)،
متاح كمُحسِّن في <code class="xref py py-class docutils literal notranslate"><span class="pre">Ridge</span></code>.</p>
<p id="sgd-online-one-class-svm">Online One-Class SVM
ينفذ الصنف <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.linear_model.SGDOneClassSVM</span></code> إصدارًا خطيًا عبر الإنترنت لخوارزمية One-Class SVM باستخدام تدرج تنازلي احتمالي. وبدمجه مع تقنيات تقريب النواة، يمكن استخدام <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.linear_model.SGDOneClassSVM</span></code> لتقريب حل خوارزمية One-Class SVM المعممة باستخدام النواة، المنفذة في الصنف <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.svm.OneClassSVM</span></code>، بتعقيد خطي في عدد العينات. لاحظ أن تعقيد خوارزمية One-Class SVM المعممة باستخدام النواة هو في أفضل الأحوال تربيعي في عدد العينات.</p>
<p>لذا، فإن الصنف <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.linear_model.SGDOneClassSVM</span></code> مناسب تمامًا لمجموعات البيانات التي تحتوي على عدد كبير من عينات التدريب (&gt; 10000) والتي يمكن أن يكون فيها الإصدار المتغير أسرع بعدة درجات من حيث المقدار.</p>
<p>يدعم كل من <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code> و:class:<code class="docutils literal notranslate"><span class="pre">SGDRegressor</span></code> و:class:<code class="docutils literal notranslate"><span class="pre">SGDOneClassSVM</span></code> خوارزمية SGD ذات المتوسط الحسابي. ويمكن تمكين المتوسط الحسابي من خلال تعيين “average=True”.</p>
</section>
<section id="id6">
<h2>خوارزمية التدرج التنازلي العشوائي للبيانات المتناثرة<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ينتج التنفيذ المتناثر نتائج مختلفة قليلاً عن التنفيذ الكثيف، وذلك بسبب تقلص معدل التعلم للمقاطعة. راجع :ref: <code class="docutils literal notranslate"><span class="pre">implementation_details</span></code> لمزيد من التفاصيل.</p>
</div>
<p>هناك دعم مدمج للبيانات المتناثرة المعطاة في أي مصفوفة بتنسيق مدعوم من قبل <code class="docutils literal notranslate"><span class="pre">scipy.sparse</span> <span class="pre">&lt;https://docs.scipy.org/doc/scipy/reference/sparse.html&gt;_</span></code>. ومع ذلك، فمن أجل تحقيق الكفاءة القصوى، استخدم تنسيق مصفوفة CSR كما هو محدد في <code class="docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span> <span class="pre">&lt;https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html&gt;_</span></code>.</p>
<p class="rubric">الأمثلة</p>
<ul class="simple">
<li><p><a class="reference internal" href="../auto_examples/text/plot_document_classification_20newsgroups.html#sphx-glr-auto-examples-text-plot-document-classification-20newsgroups-py"><span class="std std-ref">Classification of text documents using sparse features</span></a></p></li>
</ul>
</section>
<section id="id7">
<h2>التعقيد<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<p>الميزة الرئيسية لخوارزمية SGD هي كفاءتها، والتي تكون بشكل أساسي خطية في عدد الأمثلة التدريبية. إذا كانت X مصفوفة ذات حجم (n، p)، فإن التدريب يكون بتكلفة <span class="math notranslate nohighlight">\(O(k n \bar p)\)</span>، حيث k هو عدد التكرارات (الحقبات) و:math:<code class="docutils literal notranslate"><span class="pre">bar</span> <span class="pre">p</span></code> هو متوسط عدد السمات غير الصفرية لكل عينة.</p>
<p>ومع ذلك، فقد أظهرت النتائج النظرية الحديثة أن وقت التشغيل للحصول على دقة تحسين مرغوبة لا يزيد مع زيادة حجم مجموعة التدريب.</p>
</section>
<section id="id8">
<h2>معيار التوقف<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<p>يوفر الصنفان <code class="xref py py-class docutils literal notranslate"><span class="pre">SGDClassifier</span></code> و:class:<code class="docutils literal notranslate"><span class="pre">SGDRegressor</span></code> معيارين لوقف الخوارزمية عند الوصول إلى مستوى معين من التقارب:</p>
<ul class="simple">
<li><p>مع تعيين “early_stopping=True”، يتم تقسيم بيانات الإدخال إلى مجموعة تدريب ومجموعة تحقق. بعد ذلك، يتم ملاءمة النموذج على مجموعة التدريب، ويتم استناد معيار التوقف على نتيجة التنبؤ (باستخدام طريقة “score”) المحسوبة على مجموعة التحقق. يمكن تغيير حجم مجموعة التحقق باستخدام معامل “validation_fraction”.</p></li>
<li><p>مع تعيين “early_stopping=False”، يتم ملاءمة النموذج على جميع بيانات الإدخال، ويتم استناد معيار التوقف على الدالة الهدف المحسوبة على بيانات التدريب.</p></li>
</ul>
<p>في كلتا الحالتين، يتم تقييم المعيار مرة واحدة لكل حقبة، ويتوقف الخوارزم عند عدم تحسن المعيار “n_iter_no_change” مرات متتالية. يتم تقييم التحسن باستخدام تسامح مطلق “tol”، ويتوقف الخوارزم في جميع الحالات بعد عدد أقصى من التكرارات “max_iter”.</p>
</section>
<section id="id9">
<h2>نصائح للاستخدام العملي<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<ul>
<li><p>خوارزمية التدرج التنازلي العشوائي حساسة لمقياس الميزة، لذا يوصى بشدة بضبط مقياس بياناتك. على سبيل المثال، قم بضبط كل سمة في متجه الإدخال X إلى المجال [0,1] أو [-1,+1]، أو قم بتوحيدها ليكون متوسطها 0 وانحرافها المعياري 1. لاحظ أنه يجب تطبيق <em>نفس</em> الضبط على متجه الاختبار للحصول على نتائج ذات معنى. يمكن القيام بذلك بسهولة باستخدام <code class="xref py py-class docutils literal notranslate"><span class="pre">StandardScaler</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># لا تغش - قم بالضبط فقط على بيانات التدريب</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># تطبيق نفس التحويل على بيانات الاختبار</span>

<span class="c1"># أو بشكل أفضل: استخدم خط أنابيب!</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="n">est</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">SGDClassifier</span><span class="p">())</span>
<span class="n">est</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">est</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
<p>إذا كانت سماتك لها مقياس جوهري (مثل تكرارات الكلمات أو السمات المؤشرة)، فلن تكون هناك حاجة للضبط.</p>
</li>
<li><p>أفضل طريقة لإيجاد معامل ضبط مناسب <span class="math notranslate nohighlight">\(\alpha\)</span> هي باستخدام البحث التلقائي عن أفضل المعاملات، مثل <code class="xref py py-class docutils literal notranslate"><span class="pre">GridSearchCV</span></code> أو <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code>، عادة في النطاق <code class="docutils literal notranslate"><span class="pre">10.0**-np.arange(1,7)</span></code>.</p></li>
<li><p>وجدنا من الناحية التجريبية أن خوارزمية SGD تتقارب بعد ملاحظة حوالي 10^6 عينة تدريبية. وبالتالي، فإن التخمين المعقول لأول مرة لعدد التكرارات هو <code class="docutils literal notranslate"><span class="pre">max_iter</span> <span class="pre">=</span> <span class="pre">np.ceil(10**6</span> <span class="pre">/</span> <span class="pre">n)</span></code>، حيث “n” هو حجم مجموعة التدريب.</p></li>
<li><p>إذا كنت تطبق خوارزمية SGD على سمات مستخرجة باستخدام التحليل العاملي التمييزي (PCA)، فقد وجدنا أنه من الحكمة غالبًا ضبط قيم السمات بواسطة ثابت ‘c’ بحيث يكون متوسط القيمة L2 المعيارية لبيانات التدريب يساوي واحدًا.</p></li>
<li><p>وجدنا أن خوارزمية SGD ذات المتوسط الحسابي تعمل بشكل أفضل مع عدد أكبر من السمات وقيمة أعلى لـ “eta0”.</p></li>
</ul>
<p class="rubric">المراجع</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Efficient</span> <span class="pre">BackProp&quot;</span> <span class="pre">&lt;http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf&gt;_</span></code>
Y. LeCun, L. Bottou, G. Orr, K. Müller - في شبكات عصبية: حيل المهنة 1998.</p></li>
</ul>
<p id="sgd-mathematical-formulation">الصيغة الرياضية
فيما يلي نعرض التفاصيل الرياضية لإجراء “سجود” (SGD). يمكن الاطلاع على نظرة عامة جيدة مع معدلات التقارب في [6].</p>
<p>بالنسبة لمجموعة من الأمثلة التدريبية: (x1, y1)، …، (xn, yn) حيث xi ∈ R^m و- y_i inmathcal{R} (y_i ∈ {-1, 1} للتصنيف)، فإن هدفنا هو تعلم دالة تسجيل خطية: f(x) = w^T x + b مع معلمات النموذج: w ∈ R^m ومعامل الاعتراض: b ∈ R. من أجل عمل تنبؤات للتصنيف الثنائي، ما علينا سوى النظر في علامة f(x). ولإيجاد معلمات النموذج، نقوم بتقليل خطأ التدريب المنتظم المعطى بواسطة:</p>
<p>E(w,b) = frac{1}{n}sum_{i=1}^{n} L(y_i, f(x_i)) + alpha R(w)</p>
<p>حيث L هي دالة خسارة تقيس مدى ملاءمة (أو عدم ملاءمة) النموذج، وR هي مصطلح المنتظم (المعروف أيضًا باسم العقوبة) الذي يعاقب على تعقيد النموذج؛ α &gt; 0 هو فرط معلم غير سالب يتحكم في قوة التنظيم.</p>
<p>تفاصيل دالات الخسارة:</p>
<p>تؤدي خيارات مختلفة لـ L إلى مصنفات أو مرجحات مختلفة:</p>
<ul class="simple">
<li><p>هينج (هامش ناعم): ما يعادل تصنيف المتجهات الداعمة.
L(y_i, f(x_i)) = max(0, 1 - y_i f(x_i)).</p></li>
<li><p>بيرسيبترون:
L(y_i, f(x_i)) = max(0, - y_i f(x_i)).</p></li>
<li><p>هابر المعدل:
L(y_i, f(x_i)) = max(0, 1 - y_i f(x_i))^2 إذا كانت y_i f(x_i) &gt; -1، و L(y_i, f(x_i)) = -4 y_i f(x_i) في ما عدا ذلك.</p></li>
<li><p>سجل الخسارة: ما يعادل الانحدار اللوجستي.
L(y_i, f(x_i)) = log(1 + exp (-y_i f(x_i))).</p></li>
<li><p>الخطأ التربيعي: الانحدار الخطي (Ridge أو Lasso اعتمادًا على R).
L(y_i, f(x_i)) = frac{1}{2}(y_i - f(x_i))^2.</p></li>
<li><p>هابر: أقل حساسية للقيم الشاذة من طريقة المربعات الصغرى. وهو ما يعادل المربعات الصغرى عندما <a href="#id13"><span class="problematic" id="id14">|y_i - f(x_i)|</span></a> ≤ ϵ، و L(y_i, f(x_i)) = ϵ <a href="#id15"><span class="problematic" id="id16">|y_i - f(x_i)|</span></a> - frac{1}{2} ϵ^2 في ما عدا ذلك.</p></li>
<li><p>إبسيلون-غير حساس: (هامش ناعم) ما يعادل الانحدار باستخدام المتجهات الداعمة.
L(y_i, f(x_i)) = max(0, <a href="#id17"><span class="problematic" id="id18">|y_i - f(x_i)|</span></a> - ϵ).</p></li>
</ul>
<p>يمكن اعتبار جميع دالات الخسارة المذكورة أعلاه حدًا أعلى لخطأ التصنيف (خسارة الصفر-واحد) كما هو موضح في الشكل أدناه.</p>
<p>يمكن أن تشمل الخيارات الشائعة لمصطلح التنظيم R (معلمة “العقوبة”) ما يلي:</p>
<ul class="simple">
<li><p>معيار L2: R(w) := frac{1}{2} sum_{j=1}^{m} w_j^2 = ||w||_2^2،</p></li>
<li><p>معيار L1: R(w) := sum_{j=1}^{m} <a href="#id19"><span class="problematic" id="id20">|w_j|</span></a>، والذي يؤدي إلى حلول متفرقة.</p></li>
<li><p>الشبكة المرنة: R(w) := frac{rho}{2} sum_{j=1}^{n} w_j^2 + (1-rho) sum_{j=1}^{m} <a href="#id21"><span class="problematic" id="id22">|w_j|</span></a>، وهو مزيج محدب من L2 وL1، حيث يتم إعطاء ρ بواسطة “1 - l1_ratio”.</p></li>
</ul>
<p>يوضح الشكل أدناه حدود المصطلحات التنظيمية المختلفة في مساحة المعلمات ثنائية الأبعاد (m=2) عندما R(w) = 1.</p>
<section id="id10">
<h3>سجود<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>التدرج النسبي العشوائي هو طريقة للتحسين لمشكلات التحسين غير المقيدة. على عكس الانحدار التدرجي (Batch)، يقرب “سجود” التدرج الحقيقي لـ E(w,b) من خلال النظر في مثال تدريبي واحد في كل مرة.</p>
<p>تنفذ فئة SGDClassifier روتين تعلم “سجود” من الدرجة الأولى. يقوم الخوارزمية بالمرور عبر الأمثلة التدريبية، ولكل مثال، يقوم بتحديث معلمات النموذج وفقًا لقاعدة التحديث المعطاة بواسطة:</p>
<p>w leftarrow w - eta left[alpha frac{partial R(w)}{partial w} + frac{partial L(w^T x_i + b, y_i)}{partial w}right]</p>
<p>حيث η هو معدل التعلم الذي يتحكم في حجم الخطوة في مساحة المعلمات. يتم تحديث معامل الاعتراض b بشكل مشابه ولكن بدون تنظيم (وبانخفاض إضافي للمصفوفات المتناثرة، كما هو مفصل في قسم “تفاصيل التنفيذ”).</p>
<p>يمكن أن يكون معدل التعلم η ثابتًا أو متناقصًا تدريجيًا. بالنسبة للتصنيف، يكون جدول معدلات التعلم الافتراضي (learning_rate=’optimal’) كما يلي:</p>
<p>eta^{(t)} = frac {1}{alpha  (t_0 + t)}</p>
<p>حيث t هي خطوة الوقت (هناك ما مجموعه n_samples * n_iter خطوات زمنية)، ويتم تحديد t_0 بناءً على قاعدة إبهام مقترحة بواسطة Léon Bottou بحيث تكون التحديثات الأولية المتوقعة قابلة للمقارنة مع الحجم المتوقع للأوزان (هذا بافتراض أن معيار عينات التدريب يساوي تقريبًا 1). ويمكن العثور على التعريف الدقيق في _init_t في BaseSGD.</p>
<p>بالنسبة للانحدار، يكون جدول معدلات التعلم الافتراضي هو التدرج العكسي (learning_rate=’invscaling’)، كما هو موضح أدناه:</p>
<p>eta^{(t)} = frac{eta_0}{t^{power_t}}</p>
<p>حيث eta_0 وpower_t هما معلمات فائقة يختارها المستخدم من خلال eta0 وpower_t، على التوالي.</p>
<p>بالنسبة لمعدل تعلم ثابت، استخدم learning_rate=’constant’ وحدد معدل التعلم باستخدام eta0.</p>
<p>بالنسبة لمعدل تعلم متناقص تكيفيًا، استخدم learning_rate=’adaptive’ وحدد معدل التعلم الأولي باستخدام eta0. عندما يتم الوصول إلى معيار التوقف، يتم تقسيم معدل التعلم على 5، ولا يتوقف الخوارزم. يتوقف الخوارزم عندما يصبح معدل التعلم أقل من 1e-6.</p>
<p>يمكن الوصول إلى معلمات النموذج من خلال السمات “<a href="#id28"><span class="problematic" id="id29">coef_</span></a>” و”<a href="#id30"><span class="problematic" id="id31">intercept_</span></a>”: يحتفظ “<a href="#id32"><span class="problematic" id="id33">coef_</span></a>” بالأوزان w ويحتفظ “<a href="#id34"><span class="problematic" id="id35">intercept_</span></a>” بـ b.</p>
<p>عند استخدام “سجود” المتوسط (مع معلمة “average”)، يتم تعيين “<a href="#id36"><span class="problematic" id="id37">coef_</span></a>” إلى متوسط الوزن عبر جميع التحديثات:</p>
<p><a href="#id38"><span class="problematic" id="id39">coef_</span></a> := frac{1}{T} sum_{t=0}^{T-1} w^{(t)}،</p>
<p>حيث T هو العدد الإجمالي للتحديثات، الموجود في السمة <a href="#id40"><span class="problematic" id="id41">t_</span></a>.</p>
</section>
</section>
<section id="id11">
<h2>تفاصيل التنفيذ<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>تأثر تنفيذ “سجود” بـ “SVM Stochastic Gradient” من [1].</p>
<p>على غرار SvmSGD، يتم تمثيل متجه الوزن كحاصل ضرب كمية ومقدار، مما يسمح بتحديث الوزن بكفاءة في حالة التنظيم L2.</p>
<p>في حالة الإدخال المتناثر X، يتم تحديث معامل الاعتراض بمعدل تعلم أصغر (مضروبًا بـ 0.01) لمراعاة حقيقة أنه يتم تحديثه بشكل متكرر. يتم التقاط أمثلة التدريب بشكل تسلسلي ويتم تقليل معدل التعلم بعد كل مثال تمت ملاحظته. وقد اعتمدنا جدول معدلات التعلم من [2].</p>
<p>بالنسبة للتصنيف متعدد الفئات، يتم استخدام نهج “واحد مقابل الجميع”.</p>
<p>نستخدم خوارزمية التدرج المقطوع المقترحة في [3] للتنظيم L1 (والشبكة المرنة).</p>
<p>تمت كتابة الكود في Cython.</p>
<section id="id12">
<h3>المراجع<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>[1] “Stochastic Gradient Descent” &lt;<a class="reference external" href="https://leon.bottou.org/projects/sgd">https://leon.bottou.org/projects/sgd</a>&gt; L. Bottou - Website, 2010.</p>
<p>[2] “Pegasos: Primal estimated sub-gradient solver for svm” &lt;<a class="reference external" href="https://doi.org/10.1145/1273496.1273598">https://doi.org/10.1145/1273496.1273598</a>&gt; S. Shalev-Shwartz, Y. Singer, N. Srebro - In Proceedings of ICML ‘07.</p>
<p>[3] “Stochastic gradient descent training for l1-regularized log-linear models with cumulative penalty” &lt;<a class="reference external" href="https://www.aclweb.org/anthology/P/P09/P09-1054.pdf">https://www.aclweb.org/anthology/P/P09/P09-1054.pdf</a>&gt; Y. Tsuruoka, J. Tsujii, S. Ananiadou - In Proceedings of the AFNLP/ACL’09.</p>
<p>[4] “Towards Optimal One Pass Large Scale Learning with Averaged Stochastic Gradient Descent” &lt;<a class="reference external" href="https://arxiv.org/abs/1107.2490v2">https://arxiv.org/abs/1107.2490v2</a>&gt; Xu, Wei (2011)</p>
<p>[5] “Regularization and variable selection via the elastic net” &lt;<a class="reference external" href="https://doi.org/10.1111/j.1467-9868.2005.00503.x">https://doi.org/10.1111/j.1467-9868.2005.00503.x</a>&gt; H. Zou, T. Hastie - Journal of the Royal Statistical Society Series B, 67 (2), 301-320.</p>
<p>[6] “Solving large scale linear prediction problems using stochastic gradient descent algorithms” &lt;<a class="reference external" href="https://doi.org/10.1145/1015330.1015332">https://doi.org/10.1145/1015330.1015332</a>&gt; T. Zhang - In Proceedings of ICML ‘04.</p>
</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item">
<div class="prev-next-area">
</div></div>
  
</div>
                </footer>
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">التصنيف</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">الانحدار</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">خوارزمية التدرج التنازلي العشوائي للبيانات المتناثرة</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">التعقيد</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">معيار التوقف</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">نصائح للاستخدام العملي</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">سجود</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">تفاصيل التنفيذ</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">المراجع</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/modules/sgd.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2007 - 2024, scikit-learn developers (BSD License).
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>