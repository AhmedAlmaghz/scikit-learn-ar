تقدير الكثافة
==================

تقدير الكثافة هو الخط الفاصل بين التعلم غير الخاضع للإشراف، وهندسة الميزات، ونمذجة البيانات. بعض تقنيات تقدير الكثافة الأكثر شيوعًا وفائدة هي نماذج الخلط مثل المزيج الغاوسي (:class: ~ sklearn.mixture.GaussianMixture)، والأساليب المستندة إلى الجيران مثل تقدير الكثافة النووية (:class: ~ sklearn.neighbors.KernelDensity).

يتم مناقشة المزيج الغاوسي بشكل أكثر اكتمالاً في سياق التجميع (: ref: clustering`)، لأن التقنية مفيدة أيضًا كمخطط تجميع غير خاضع للإشراف.

تقدير الكثافة مفهوم بسيط جدًا، ومعظم الأشخاص على دراية بالفعل بتقنية تقدير الكثافة الشائعة: مخطط توزيع التكرارات.

تقدير الكثافة: مخططات توزيع التكرارات
==================================

مخطط توزيع التكرارات هو تمثيل مرئي بسيط للبيانات حيث يتم تحديد الخانات، ويتم حساب عدد نقاط البيانات الموجودة داخل كل خانة. يمكن رؤية مثال على مخطط توزيع التكرارات في اللوحة العلوية اليسرى من الشكل التالي:

|hist_to_kde|

ومع ذلك، تتمثل إحدى المشكلات الرئيسية في مخططات توزيع التكرارات في أن اختيار التخانة يمكن أن يكون له تأثير غير متناسب على التمثيل المرئي الناتج. ضع في اعتبارك اللوحة العلوية اليمنى من الشكل أعلاه. فهو يُظهر مخطط توزيع التكرارات على نفس البيانات، مع تحول الخانات إلى اليمين. تبدو نتائج التمثيلين المرئيين مختلفين تمامًا، وقد تؤدي إلى تفسيرات مختلفة للبيانات.

يمكن للمرء أن يفكر أيضًا بشكل حدسي في مخطط توزيع التكرارات على أنه مكدس من الكتل، كتلة واحدة لكل نقطة. عن طريق تكديس الكتل في مساحة الشبكة المناسبة، نحصل على مخطط توزيع التكرارات. ولكن ماذا لو قمنا، بدلاً من تكديس الكتل على شبكة منتظمة، بمحاذاة كل كتلة مع النقطة التي تمثلها، وجمع الارتفاع الإجمالي في كل موقع؟ تؤدي هذه الفكرة إلى التمثيل المرئي في اللوحة السفلية اليسرى. قد لا يكون هذا التمثيل نظيفًا مثل مخطط توزيع التكرارات، ولكن حقيقة أن البيانات تدفع مواقع الكتل تعني أنها تمثل البيانات الأساسية بشكل أفضل.

هذا التمثيل المرئي هو مثال على *تقدير الكثافة النووية*، في هذه الحالة مع نواة على شكل أسطوانة (أي كتلة مربعة في كل نقطة). يمكننا استرداد توزيع أكثر سلاسة باستخدام نواة أكثر سلاسة. يُظهر المخطط السفلي الأيمن تقدير كثافة نواة غاوسي، حيث تساهم كل نقطة بمنحنى غاوسي في الإجمالي. النتيجة هي تقدير كثافة سلس مشتق من البيانات، ويعمل كنموذج غير معلم قوي لتوزيع النقاط.

تقدير الكثافة النووية
=========================

يتم تنفيذ تقدير الكثافة النووية في مجموعة أدوات التعلم في مؤشر كتلة الجسم :class: ~ sklearn.neighbors.KernelDensity`، والذي يستخدم شجرة الكرة أو شجرة KD للاستعلامات الفعالة (راجع: ref: neighbors` لمناقشة هذه الشجرة). على الرغم من أن المثال أعلاه يستخدم مجموعة بيانات أحادية البعد لتبسيط الأمر، إلا أنه يمكن إجراء تقدير الكثافة النووية في أي عدد من الأبعاد، على الرغم من أن لعنة الأبعاد في الممارسة العملية تسبب تدهور أدائها في الأبعاد العالية.

في الشكل التالي، يتم رسم 100 نقطة من توزيع ثنائي النمط، ويتم إظهار تقديرات الكثافة النووية لثلاثة خيارات من النواة:

|kde_1d_distribution|

من الواضح كيف يؤثر شكل النواة على سلاسة التوزيع الناتج. يمكن استخدام مُقدِّر الكثافة النووية في مجموعة أدوات التعلم كما يلي:

>>> from sklearn.neighbors import KernelDensity
>>> import numpy as np
>>> X = np.array([[-1, -1], [-2, -1], [-3, -2], [1, 1], [2, 1], [3, 2]])
>>> kde = KernelDensity(kernel='gaussian', bandwidth=0.2).fit(X)
>>> kde.score_samples(X)
array([-0.41075698, -0.41075698, -0.41076071, -0.41075698, -0.41075698,
        -0.41076071])

هنا استخدمنا "kernel='gaussian'"، كما هو موضح أعلاه.

رياضيًا، النواة هي دالة إيجابية :math: K (x؛ ح) يتم التحكم فيها بواسطة معلمة عرض النطاق الترددي :math: ح. بالنظر إلى هذا الشكل النووي، فإن تقدير الكثافة في نقطة :math: y داخل مجموعة من النقاط :math: x_i؛ i = 1 \ cdot N يعطى بما يلي:

.. math::
\rho_K (y) = \ sum_ {i = 1} ^ {N} K (y - x_i؛ ح)

يعمل عرض النطاق الترددي هنا كمعلمة تنعيم، حيث يتحكم في المقايضة بين الانحياز والتشتت في النتيجة. يؤدي عرض النطاق الترددي الكبير إلى توزيع كثافة سلس للغاية (أي عالي الانحياز). يؤدي عرض النطاق الترددي الصغير إلى توزيع كثافة غير سلس (أي عالي التباين).

تتحكم معلمة "bandwidth" في هذا التنعيم. يمكن للمرء إما تعيين هذه المعلمة يدويًا أو استخدام طرق تقدير Scott وSilvermann.

:class: ~ sklearn.neighbors.KernelDensity` ينفذ العديد من أشكال النواة الشائعة، والتي يتم توضيحها في الشكل التالي:

|kde_kernels|

.. dropdown:: التعبيرات الرياضية للنواة

  الشكل الرياضي لهذه النواة هو كما يلي:

  * النواة الغاوسية (النواة = "الغاوسية")

    :math: K (x؛ ح) \ يتناسب مع exp (- \ frac {x ^ 2} {2h ^ 2})

  * نواة أسطوانية (النواة = "أسطوانية")

    :math: K (x؛ ح) \ يتناسب مع 1 `إذا: math: x <ح

  * نواة Epanechnikov (النواة = "Epanechnikov")

    :math: K (x؛ ح) \ يتناسب مع 1 - \ frac {x ^ 2} {ح ^ 2}

  * النواة الأسية (النواة = "الأسية")

    :math: K (x؛ ح) \ يتناسب مع exp (- x / ح)

  * النواة الخطية (النواة = "خطية")

    :math: K (x؛ ح) \ يتناسب مع 1 - x / ح `إذا: math: x <ح

  * نواة جيب التمام (النواة = "جيب التمام")

    :math: K (x؛ ح) \ يتناسب مع \ cos (\ frac {\ pi x} {2h}) `إذا: math: x <ح

يمكن استخدام مُقدِّر الكثافة النووية مع أي من مقاييس المسافة الصالحة (راجع: class: ~ sklearn.metrics.DistanceMetric` للحصول على قائمة بالمقاييس المتاحة)، على الرغم من أن النتائج تكون معيارية بشكل صحيح فقط للمسافة الإقليدية. إحدى المقاييس المفيدة بشكل خاص هي `مسافة Haversine <https://en.wikipedia.org/wiki/Haversine_formula>`_ والتي تقيس المسافة الزاوية بين نقطتين على كرة. فيما يلي مثال على استخدام تقدير الكثافة النووية لتمثيل مرئي للبيانات الجغرافية المكانية، في هذه الحالة توزيع الملاحظات لنوعين مختلفين على القارة الأمريكية الجنوبية:

|species_kde|

هناك تطبيق مفيد آخر لتقدير الكثافة النووية وهو تعلم نموذج تناسلي غير معلم لمجموعة بيانات من أجل إجراء عينات جديدة من هذا النموذج التناسلي بكفاءة.

فيما يلي مثال على استخدام هذه العملية لإنشاء مجموعة جديدة من الأرقام المكتوبة بخط اليد، باستخدام نواة غاوسية تم تعلمها على إسقاط PCA للبيانات:

|digits_kde|

تتكون البيانات "الجديدة" من تركيبات خطية للبيانات المدخلة، مع أوزان يتم رسمها احتماليًا بالنظر إلى نموذج KDE.

.. rubric:: أمثلة

* :ref: sphx_glr_auto_examples_neighbors_plot_kde_1d.py: حساب تقديرات الكثافة النووية البسيطة في بُعد واحد.

* :ref: sphx_glr_auto_examples_neighbors_plot_digits_kde_sampling.py: مثال على استخدام تقدير كثافة النواة لتعلم نموذج تناسلي للبيانات المكتوبة بخط اليد، واستخلاص عينات جديدة من هذا النموذج.

* :ref: sphx_glr_auto_examples_neighbors_plot_species_kde.py: مثال على تقدير كثافة النواة باستخدام مسافة Haversine لتصور البيانات الجغرافية المكانية.