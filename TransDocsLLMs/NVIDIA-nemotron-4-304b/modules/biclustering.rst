  بثنائيات التجميع (Biclustering)
    ==============================

    تقوم خوارزميات التجميع الثنائية بتجميع صفوف وأعمدة مصفوفة البيانات في آن واحد. تُعرف مجموعات الصفوف والأعمدة هذه باسم البثنائيات. يحدد كل منها مصفوفة فرعية للمصفوفة الأصلية مع بعض الخصائص المرغوبة.

    على سبيل المثال، نظراً لمصفوفة ذات شكل ``(10، 10)``، يمكن أن تحث إحدى البثنائيات المحتملة بثلاثة صفوف واثنين من الأعمدة على مصفوفة فرعية ذات شكل ``(3، 2)``:

    >>> import numpy as np
    >>> data = np.arange(100).reshape(10, 10)
    >>> rows = np.array([0, 2, 3])[:, np.newaxis]
    >>> columns = np.array([1, 2])
    >>> data[rows, columns]
    array([[ 1,  2],
           [21, 22],
           [31, 32]])

    لأغراض التصور، يمكن إعادة ترتيب صفوف وأعمدة مصفوفة البيانات لجعل البثنائيات متجاورة.

    تختلف الخوارزميات في كيفية تعريفها للبثنائيات. بعض الأنواع الشائعة تشمل:

    * القيم الثابتة، الصفوف الثابتة، أو الأعمدة الثابتة
    * القيم العالية أو المنخفضة بشكل غير عادي
    * المصفوفات الفرعية ذات التباين المنخفض
    * الصفوف المترابطة أو الأعمدة

    تختلف الخوارزميات أيضاً في كيفية تعيين الصفوف والأعمدة للبثنائيات، مما يؤدي إلى هياكل بثنائية مختلفة. تحدث هياكل القطرية (Block Diagonal) أو رقعة الشطرنج (Checkerboard) عندما يتم تقسيم الصفوف والأعمدة إلى أقسام.

    إذا كان كل صف وكل عمود ينتمي إلى بثنائية واحدة فقط، فإن إعادة ترتيب صفوف وأعمدة مصفوفة البيانات يكشف عن البثنائيات على القطرية. فيما يلي مثال على هذا التركيب حيث تحتوي البثنائيات على قيم أعلى من الصفوف والأعمدة الأخرى:

    .. figure:: ../auto_examples/bicluster/images/sphx_glr_plot_spectral_coclustering_003.png
       :target: ../auto_examples/bicluster/images/sphx_glr_plot_spectral_coclustering_003.png
       :align: center
       :scale: 50

       مثال على البثنائيات المشكّلة بتقسيم الصفوف والأعمدة.

    في حالة رقعة الشطرنج، ينتمي كل صف إلى جميع مجموعات الأعمدة، وينتمي كل عمود إلى جميع مجموعات الصفوف. فيما يلي مثال على هذا التركيب حيث يكون تباين القيم داخل كل بثنائية صغير:

    .. figure:: ../auto_examples/bicluster/images/sphx_glr_plot_spectral_biclustering_003.png
       :target: ../auto_examples/bicluster/images/sphx_glr_plot_spectral_biclustering_003.png
       :align: center
       :scale: 50

       مثال على بثنائيات رقعة الشطرنج.

    بعد تركيب نموذج، يمكن العثور على عضوية مجموعة الصفوف والأعمدة في السمتين ``rows_`` و ``columns_``. ``rows_[i]`` هو متجه ثنائي مع إدخالات غير صفرية المقابلة للصفوف التي تنتمي إلى البثنائية ``i``. وبالمثل، يشير ``columns_[i]`` إلى الأعمدة التي تنتمي إلى البثنائية ``i``.

    تحتوي بعض النماذج أيضاً على سِمات ``row_labels_`` و ``column_labels_``. هذه النماذج تقسم الصفوف والأعمدة، كما هو الحال في هياكل البثنائيات القطرية ورقعة الشطرنج.

    .. note::

        يحتوي التجميع الثنائي على العديد من الأسماء الأخرى في مجالات مختلفة بما في ذلك التجميع المشترك، التجميع ثنائي الوضع، التجميع ثنائي الاتجاه، تجميع الكتل، التجميع الثنائي الموحد، وما إلى ذلك. تعكس أسماء بعض الخوارزميات، مثل خوارزمية التجميع المشترك الطيفي، هذه الأسماء البديلة.


    .. currentmodule:: sklearn.cluster


    .. _spectral_coclustering:

    التجميع المشترك الطيفي (Spectral Co-Clustering)
    ==========================================

    يبحث خوارزمية :class:`SpectralCoclustering` عن البثنائيات ذات القيم الأعلى من تلك الموجودة في الصفوف والأعمدة المقابلة الأخرى. كل صف وكل عمود ينتمي إلى بثنائية واحدة فقط، لذلك فإن إعادة ترتيب الصفوف والأعمدة لجعل الأقسام متجاورة يكشف عن هذه القيم العالية على القطرية:

    .. note::

        تتعامل الخوارزمية مع مصفوفة بيانات الإدخال كمخطط ثنائي: تتوافق صفوف وأعمدة المصفوفة مع مجموعتي القمم، ويتوافق كل إدخال مع حافة بين صف وعمود. تقوم الخوارزمية بتقريب القطع الطبيعي لهذا المخطط للعثور على المخططات الفرعية الثقيلة.


    الصياغة الرياضية
    ----------------

    يمكن العثور على حل تقريبي للقطع الطبيعي الأمثل من خلال التحليل العاملي للقيمة الذاتية للابلاسية للمخطط. عادة ما يعني هذا العمل مباشرة مع مصفوفة لابلاسية. إذا كانت مصفوفة البيانات الأصلية :math:`A` لها الشكل :math:`m \times n`، فإن مصفوفة لابلاسية للمخطط الثنائي المقابل لها الشكل :math:`(m + n) \times (m + n)`. ومع ذلك، في هذه الحالة من الممكن العمل مباشرة مع :math:`A`، وهو أصغر وأكثر كفاءة.

    يتم معالجة مصفوفة الإدخال :math:`A` مسبقاً على النحو التالي:

    .. math::
        A_n = R^{-1/2} A C^{-1/2}

    حيث :math:`R` هي المصفوفة القطرية ذات الإدخال :math:`i` يساوي :math:`\sum_{j} A_{ij}` و :math:`C` هي المصفوفة القطرية ذات الإدخال :math:`j` يساوي :math:`\sum_{i} A_{ij}`.

    يوفر تحليل القيمة التفردية، :math:`A_n = U \Sigma V^\top`، تقسيمات الصفوف والأعمدة لـ :math:`A`. توفر مجموعة فرعية من متجهات التفرد اليسرى مجموعات الصفوف، وتوفر مجموعة فرعية من متجهات التفرد اليمنى مجموعات الأعمدة.

    توفر متجهات التفرد :math:`\ell = \lceil \log_2 k \rceil`، بدءاً من الثاني، معلومات التقسيم المطلوبة. يتم استخدامها لتشكيل المصفوفة :math:`Z`:

    .. math::
        Z = \begin{bmatrix} R^{-1/2} U \\\\
                            C^{-1/2} V
              \end{bmatrix}

    حيث تكون أعمدة :math:`U` هي :math:`u_2, \dots, u_{\ell + 1}`, وبالمثل بالنسبة إلى :math:`V`.

    ثم يتم تجميع صفوف :math:`Z` باستخدام :ref:`k-means <k_means>`. توفر التسميات الأولى ``n_rows`` تقسيم الصفوف، وتوفر التسميات الباقية ``n_columns`` تقسيم الأعمدة.


    .. rubric:: أمثلة

    * :ref:`sphx_glr_auto_examples_bicluster_plot_spectral_coclustering.py`: مثال بسيط يوضح كيفية إنشاء مصفوفة بيانات باستخدام البثنائيات وتطبيق هذه الطريقة عليها.

    * :ref:`sphx_glr_auto_examples_bicluster_plot_bicluster_newsgroups.py`: مثال على العثور على البثنائيات في مجموعة بيانات أخبار العشرين.


    .. rubric:: المراجع

    * Dhillon, Inderjit S, 2001. :doi:`Co-clustering documents and words using
      bipartite spectral graph partitioning
      <10.1145/502512.502550>`


    .. _spectral_biclustering:

    التجميع الثنائي الطيفي (Spectral Biclustering)
    ------------------------------------------------

الخوارزمية :class:`SpectralBiclustering` تفترض أن مصفوفة البيانات المدخلة لها بنية مخفية على شكل رقعة شطرنج. يمكن تقسيم صفوف وأعمدة المصفوفة ذات هذه البنية بحيث تكون مدخلات أي مجموعة ثنائية في ناتج الضرب الديكارتي لتجمعات الصفوف والأعمدة ثابتة تقريبًا. على سبيل المثال، إذا كان هناك قسمان للصفوف وثلاثة أقسام للأعمدة، فسينتمي كل صف إلى ثلاث مجموعات ثنائية، وسينتمي كل عمود إلى مجموعتين ثنائيتين.

تقوم الخوارزمية بتقسيم صفوف وأعمدة المصفوفة بحيث توفر مصفوفة رقعة الشطرنج المقابلة الثابتة تقريبيًا تقريبًا جيدًا للمصفوفة الأصلية.


الصياغة الرياضية
------------------------

يتم أولاً تطبيع مصفوفة الدخل :math:`A` لجعل نمط رقعة الشطرنج أكثر وضوحًا. هناك ثلاث طرق ممكنة:

1. *التطبيع المستقل للصفوف والأعمدة*، كما في التنظير الطيفي المشترك. تجعل هذه الطريقة الصفوف تجمع إلى ثابت والأعمدة تجمع إلى ثابت مختلف.

2. **Bistochastization**: تكرار تطبيع الصفوف والأعمدة حتى التقارب. تجعل هذه الطريقة كل من الصفوف والأعمدة تجمع إلى نفس الثابت.

3. **تطبيع اللوغاريتم**: يتم حساب لوغاريتم مصفوفة البيانات: :math:`L = \log A`. ثم يتم حساب متوسط العمود :math:`\overline{L_{i \cdot}}`، ومتوسط الصف :math:`\overline{L_{\cdot j}}`، والمتوسط العام :math:`\overline{L_{\cdot \cdot}}` لـ :math:`L`. يتم حساب المصفوفة النهائية وفقًا للمعادلة

.. math::
    K_{ij} = L_{ij} - \overline{L_{i \cdot}} - \overline{L_{\cdot
    j}} + \overline{L_{\cdot \cdot}}

بعد التطبيع، يتم حساب أول بعض المتجهات المتفردة، كما هو الحال في خوارزمية Spectral Co-Clustering.

إذا تم استخدام تطبيع اللوغاريتم، فإن جميع المتجهات المتفردة تكون ذات مغزى. ومع ذلك، إذا تم استخدام التطبيع المستقل أو bistochastization، يتم التخلص من أول المتجهات المتفردة، :math:`u_1` و :math:`v_1`. من الآن فصاعدًا، يشير "أول" المتجهات المتفردة إلى :math:`u_2 \dots u_{p+1}` و :math:`v_2 \dots v_{p+1}` باستثناء حالة تطبيع اللوغاريتم.

بالنظر إلى هذه المتجهات المتفردة، يتم ترتيبها وفقًا لما يمكن أن يتم تقريبها بشكل أفضل بواسطة متجه ثابت على مراحل. يتم العثور على التقريب لكل متجه باستخدام k-means أحادي البعد وتسجيله باستخدام المسافة الإقليدية. يتم تحديد مجموعة فرعية من أفضل المتجهات المتفردة اليسرى واليمنى. بعد ذلك، يتم إسقاط البيانات على هذه المجموعة الفرعية الأفضل من المتجهات المتفردة وتجميعها.

على سبيل المثال، إذا تم حساب :math:`p` متجه متفرد، فسيتم العثور على أفضل :math:`q` كما هو موضح، حيث :math:`q<p`. لنفترض أن :math:`U` هي المصفوفة ذات الأعمدة أفضل :math:`q` متجه متفرد أيسر، وبالمثل :math:`V` لليمين. لتقسيم الصفوف، يتم إسقاط صفوف :math:`A` على مساحة :math:`q` الأبعاد: :math:`A * V`. من خلال التعامل مع صفوف :math:`m` هذه للمصفوفة :math:`m \times q` كعينات وتجميعها باستخدام k-means تنتج تسميات الصفوف. وبالمثل، إسقاط الأعمدة إلى :math:`A^{\top} * U` وتجميع مصفوفة :math:`n \times q` هذه ينتج تسميات العمود.


.. rubric:: أمثلة

* :ref:`sphx_glr_auto_examples_bicluster_plot_spectral_biclustering.py`: مثال بسيط يوضح كيفية إنشاء مصفوفة رقعة الشطرنج وتجميعها بشكل ثنائي.


.. rubric:: المراجع

* Kluger، Yuval، وآخرون.، 2003. :doi:`Spectral biclustering of microarray
 data: coclustering genes and conditions
  <10.1101/gr.648603>`


.. _biclustering_evaluation:

.. currentmodule:: sklearn.metrics

تقييم التجميع الثنائي
=======================

هناك طريقتان لتقييم نتيجة التجميع الثنائي: داخلية وخارجية. تعتمد التدابير الداخلية، مثل استقرار الكتلة، فقط على البيانات والنتيجة أنفسهما. حاليًا لا توجد مقاييس مجموعات ثنائية داخلية في scikit-learn. تشير التدابير الخارجية إلى مصدر خارجي للمعلومات، مثل الحل الحقيقي. عندما تعمل مع بيانات حقيقية، يكون الحل الحقيقي عادة غير معروف، ولكن تجميع البيانات الاصطناعية قد يكون مفيدًا لتقييم الخوارزميات بالضبط لأن الحل الحقيقي معروف.

لمقارنة مجموعة من مجموعات التجميع الثنائية المحددة بمجموعة مجموعات التجميع الثنائية الحقيقية، هناك حاجة إلى مقياسين للتشابه: مقياس تشابه للمجموعات الثنائية الفردية، وطريقة لتجميع أوجه التشابه الفردية هذه في درجة إجمالية.

لمقارنة مجموعات التجميع الثنائية الفردية، تم استخدام العديد من التدابير. في الوقت الحالي، يتم تنفيذ مؤشر Jaccard فقط:

.. math::
    J(A, B) = \frac{|A \cap B|}{|A| + |B| - |A \cap B|}

حيث :math:`A` و :math:`B` هما مجموعتان ثنائيتان، :math:`|A \cap B|` هو
عدد العناصر في تقاطعهما. يحقق مؤشر Jaccard أدنى قيمة له وهي 0 عندما لا تتداخل المجموعات الثنائية على الإطلاق وأقصى قيمة له وهي 1 عندما تكون متطابقة.

تم تطوير العديد من الطرق لمقارنة مجموعتين من مجموعات التجميع الثنائية.
في الوقت الحالي، تتوفر :func:`consensus_score` (Hochreiter et. al., 2010) فقط:

1. حساب أوجه التشابه في مجموعة التجميع الثنائية للأزواج من مجموعات التجميع الثنائية، واحد في كل
   مجموعة، باستخدام مؤشر Jaccard أو مقياس مشابه.

2. تعيين مجموعات التجميع الثنائية من مجموعة إلى أخرى بطريقة فردية
   لزيادة مجموع أوجه التشابه الخاصة بهم. يتم تنفيذ هذه الخطوة
   باستخدام :func:`scipy.optimize.linear_sum_assignment`، والتي تستخدم خوارزمية Jonker-Volgenant المعدلة.

3. يتم تقسيم المجموع النهائي للتشابهات على حجم المجموعة الأكبر.

تحدث أدنى درجة توافق، 0، عندما تكون جميع أزواج مجموعات التجميع الثنائية غير متشابهة تمامًا. تحدث أعلى درجة، 1، عندما تكون كلا المجموعتين متطابقتين.


.. rubric:: المراجع

* Hochreiter، Bodenhofer، وآخرون.، 2010. `FABIA: factor analysis
 for bicluster acquisition
  <https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2881408/>`__.

    
