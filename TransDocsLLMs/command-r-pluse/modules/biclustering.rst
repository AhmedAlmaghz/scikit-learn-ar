التجميع الثنائي

تُجمّع خوارزميات التجميع الثنائي صفوف وأعمدة مصفوفة البيانات في وقت واحد. وتُعرف مجموعات الصفوف والأعمدة هذه باسم التجمعات الثنائية. ويحدد كل منها مصفوفة فرعية لمصفوفة البيانات الأصلية مع بعض الخصائص المرغوبة.

على سبيل المثال، بالنظر إلى مصفوفة ذات شكل (10، 10)، قد ينتج تجمع ثنائي واحد مكون من ثلاثة صفوف وعمودين مصفوفة فرعية ذات شكل (3، 2)::

بالنسبة لغايات التصوير، يمكن إعادة ترتيب صفوف وأعمدة مصفوفة البيانات لجعل التجمع الثنائي متجاورًا.

تختلف الخوارزميات في كيفية تعريفها للتجمعات الثنائية. فيما يلي بعض الأنواع الشائعة:

* القيم الثابتة، أو الصفوف الثابتة، أو الأعمدة الثابتة
* القيم العالية أو المنخفضة بشكل غير عادي
* المصفوفات الفرعية ذات الانحراف المعياري المنخفض
* الصفوف أو الأعمدة المترابطة

تختلف الخوارزميات أيضًا في كيفية تعيين الصفوف والأعمدة إلى التجمعات الثنائية، مما يؤدي إلى هياكل تجمع ثنائي مختلفة. تحدث الهياكل المقطعية المائلة أو هياكل رقعة الشطرنج عندما يتم تقسيم الصفوف والأعمدة إلى أقسام.

إذا كان كل صف وكل عمود ينتمي إلى تجمع ثنائي واحد بالضبط، فإن إعادة ترتيب الصفوف والأعمدة في مصفوفة البيانات تكشف عن التجمعات الثنائية على القطر. فيما يلي مثال على هذا الهيكل حيث يكون للتجمعات الثنائية قيم متوسطة أعلى من الصفوف والأعمدة الأخرى:

في حالة رقعة الشطرنج، ينتمي كل صف إلى جميع مجموعات العمود، وينتمي كل عمود إلى جميع مجموعات الصف. فيما يلي مثال على هذا الهيكل حيث انحراف القيم داخل كل تجمع ثنائي صغير:

بعد ملاءمة نموذج، يمكن العثور على عضوية مجموعة الصف والعمود في السمات "صفوف" و"أعمدة". "صفوف [i]" هو متجه ثنائي مع إدخالات غير صفرية مطابقة للصفوف التي تنتمي إلى التجمع الثنائي "i". وبالمثل، يشير "أعمدة [i]" إلى الأعمدة التي تنتمي إلى التجمع الثنائي "i".

تتوفر بعض النماذج أيضًا في السمات "تسميات_الصف" و"تسميات_العمود". تقسم هذه النماذج الصفوف والأعمدة، كما هو الحال في هياكل التجمعات الثنائية المقطعية المائلة ورقعة الشطرنج.

ملاحظة:

للتجميع الثنائي أسماء كثيرة في مجالات مختلفة بما في ذلك التجميع المشترك، وتجميع الوضع الثنائي، والتجميع ثنائي الاتجاه، وتجميع الكتل، وتجميع ثنائي الاتجاه المقترن، وما إلى ذلك. وتعكس أسماء بعض الخوارزميات، مثل خوارزمية التجميع المشترك الطيفي، هذه الأسماء البديلة.

التجميع المشترك الطيفي

تعثر خوارزمية SpectralCoclustering على تجمعات ثنائية ذات قيم أعلى من تلك الموجودة في الصفوف والأعمدة المقابلة الأخرى. ينتمي كل صف وكل عمود إلى تجمع ثنائي واحد بالضبط، لذا فإن إعادة ترتيب الصفوف والأعمدة لجعل الأقسام متجاورة تكشف عن هذه القيم العالية على القطر:

ملاحظة:

تتعامل الخوارزمية مع مصفوفة البيانات المدخلة على أنها رسم بياني ثنائي: الصفوف والأعمدة في المصفوفة المقابلة لمجموعتي الرؤوس، وكل إدخال يقابل حافة بين صف وعمود. تقارب الخوارزمية القطع المطبعي العادي لهذا الرسم البياني للعثور على الرسوم البيانية الفرعية الثقيلة.

الصيغة الرياضية

يمكن العثور على حل تقريبي للقطع المطبعي العادي الأمثل عبر التحلل القيمي العام لمصفوفة لابلاسيان للرسم البياني. عادةً ما يعني ذلك العمل مباشرةً مع مصفوفة لابلاسيان. إذا كانت مصفوفة البيانات الأصلية A ذات شكل رياضي m × n، فإن مصفوفة لابلاسيان للرسم البياني الثنائي المقابل لها شكل (m + n) × (m + n). ومع ذلك، في هذه الحالة، من الممكن العمل مباشرةً مع A، وهو أصغر وأكثر كفاءة.

يتم معالجة المصفوفة المدخلة A على النحو التالي:

حيث R هي المصفوفة القطرية مع الإدخال i يساوي ∑ j A i j و C هي المصفوفة القطرية مع الإدخال j يساوي ∑ i A i j.

يوفر التحلل القيمي الفردي، A n = U ∑ V ⊤، أقسام الصفوف والأعمدة للمصفوفة A. توفر مجموعة من المتجهات الفردية اليسرى أقسام الصفوف، وتوفر مجموعة من المتجهات الفردية اليمنى أقسام الأعمدة.

يوفر المتجهات الفردية ℓ = ⌈log2 k⌉، بدءًا من الثاني، معلومات التقسيم المطلوبة. يتم استخدامها لتشكيل المصفوفة Z:

حيث تكون أعمدة U هي u 2، ...، u ℓ + 1، وبالمثل لـ V.

بعد ذلك، يتم تجميع صفوف Z باستخدام k-means. توفر التسميات n_rows الأولى تسميات التقسيم الصفوف، وتوفر التسميات المتبقية n_columns تسميات التقسيم العمودي.

الأمثلة

* sphx_glr_auto_examples_bicluster_plot_spectral_coclustering.py: مثال بسيط يوضح كيفية إنشاء مصفوفة بيانات بتجمعات ثنائية وتطبيق هذه الطريقة عليها.

* sphx_glr_auto_examples_bicluster_plot_bicluster_newsgroups.py: مثال على العثور على تجمعات ثنائية في مجموعة بيانات مجموعات الأخبار العشرين.

المراجع

* Inderjit S Dhillon، 2001. التجميع المشترك للوثائق والكلمات باستخدام تقسيم الرسم البياني الطيفي الثنائي.

التجميع الطيفي الثنائي

تفترض خوارزمية SpectralBiclustering أن مصفوفة البيانات المدخلة لها هيكل رقعة شطرنج مخفي. يمكن تقسيم صفوف وأعمدة المصفوفة ذات هذا الهيكل بحيث تكون إدخالات أي تجمع ثنائي في المنتج الديكارتي لمجموعات الصفوف والأعمدة ثابتة تقريبًا. على سبيل المثال، إذا كان هناك قسمين صفين وثلاثة أقسام أعمدة، فسينتمي كل صف إلى ثلاثة تجمعات ثنائية، وسينتمي كل عمود إلى تجمعين ثنائيين.

تقسم الخوارزمية صفوف وأعمدة المصفوفة بحيث توفر مصفوفة رقعة الشطرنج ثابتة القطع تقريبًا جيدًا للمصفوفة الأصلية.

الصيغة الرياضية

يتم تطبيع مصفوفة الإدخال A أولاً لجعل نمط رقعة الشطرنج أكثر وضوحًا. هناك ثلاث طرق ممكنة:

1. التطبيع المستقل للصف والعمود، كما هو الحال في التجميع المشترك الطيفي. تجعل هذه الطريقة الصفوف تصل إلى ثابت والأعمدة تصل إلى ثابت مختلف.

2. التطبيع ثنائي الاتجاه: التطبيع المتكرر للصفوف والأعمدة حتى التقارب. تجعل هذه الطريقة كلاً من الصفوف والأعمدة يصل مجموعها إلى ثابت واحد.

3. التطبيع اللوغاريتمي: يتم حساب اللوغاريتم لمصفوفة البيانات: L = log A. ثم يتم حساب متوسط العمود L i ·، ومتوسط الصف L · j، والمتوسط العام L · · لمصفوفة L. يتم حساب المصفوفة النهائية وفقًا للمعادلة التالية

بعد التطبيع، يتم حساب المتجهات الفردية الأولى، تمامًا كما هو الحال في خوارزمية التجميع المشترك الطيفي.

إذا تم استخدام التطبيع اللوغاريتمي، فإن جميع المتجهات الفردية ذات معنى. ومع ذلك، إذا تم استخدام التطبيع المستقل أو التطبيع ثنائي الاتجاه، يتم تجاهل المتجهات الفردية الأولى، u 1 و v 1. من الآن فصاعدًا، يشير مصطلح "المتجهات الفردية الأولى" إلى u 2 ... u p + 1 و v 2 ... v p + 1 باستثناء حالة التطبيع اللوغاريتمي.

بالنظر إلى هذه المتجهات الفردية، يتم تصنيفها وفقًا لأي منها يمكن تقريبه بشكل أفضل بواسطة متجه ثابت القطعة. يتم العثور على التقريبات لكل متجه باستخدام k-means أحادي البعد وتتم درجتها باستخدام المسافة الإقليدية. يتم اختيار بعض المتجهات الفردية اليسرى واليمنى الأفضل. بعد ذلك، يتم إسقاط البيانات على هذه المجموعة الفرعية من أفضل المتجهات الفردية وتجميعها.

على سبيل المثال، إذا تم حساب p من المتجهات الفردية، يتم العثور على q الأفضل كما هو موصوف، حيث q < p. دع U تكون المصفوفة ذات الأعمدة q من أفضل المتجهات الفردية اليسرى، وبالمثل لـ V لليمين. لتقسيم الصفوف، يتم إسقاط صفوف A إلى مساحة q الأبعاد: A * V. يؤدي التعامل مع الصفوف m لهذه المصفوفة m × q كعينات وتجميعها باستخدام k-means إلى تسميات الصف. وبالمثل، يؤدي إسقاط الأعمدة إلى A ⊤ * U وتجميع هذه المصفوفة n × q إلى تسميات العمود.

الأمثلة

* sphx_glr_auto_examples_bicluster_plot_spectral_biclustering.py: مثال بسيط يوضح كيفية إنشاء مصفوفة رقعة شطرنج وتجميعها ثنائيًا.

المراجع

* Yuval Kluger et al.، 2003. التجميع الطيفي للبيانات المصفوفة: التجميع المشترك للجينات والشروط.

تقييم التجميع الثنائي

هناك طريقتان لتقييم نتيجة التجميع الثنائي: داخلي وخارجي. تعتمد المقاييس الداخلية، مثل استقرار التجمع، على البيانات والنتائج فقط. لا توجد حاليًا أي تدابير تجميع ثنائي داخلية في scikit-learn. تشير المقاييس الخارجية إلى مصدر معلومات خارجي، مثل الحل الحقيقي. عند العمل مع بيانات حقيقية، عادة ما تكون الحل الحقيقي غير معروف، ولكن قد يكون التجميع الثنائي للبيانات الاصطناعية مفيدًا لتقييم الخوارزميات بدقة لأن الحل الحقيقي معروف.

لمقارنة مجموعة من التجمعات الثنائية التي تم العثور عليها بمجموعة من التجمعات الثنائية الحقيقية، هناك حاجة إلى مقياسين للتشابه: مقياس تشابه للتجمعات الثنائية الفردية، وطريقة لدمج هذه التشابهات الفردية في درجة عامة.

لمقارنة التجمعات الثنائية الفردية، تم استخدام عدة مقاييس. حاليًا، يتم تنفيذ مؤشر جاكارد فقط:

حيث A و B عبارة عن تجمعات ثنائية، | A ∩ B | هو عدد العناصر في تقاطعها. يحقق مؤشر جاكارد الحد الأدنى من 0 عندما لا تتداخل التجمعات الثنائية على الإطلاق وحد أقصى من 1 عندما تكون متطابقة.

تم تطوير عدة طرق لمقارنة مجموعتين من التجمعات الثنائية. حاليًا، فإن درجة التوافق (Hochreiter et. al.، 2010) هي الطريقة الوحيدة المتاحة:

1. حساب تشابهات التجمعات الثنائية لأزواج من التجمعات الثنائية، أحدهما في كل مجموعة، باستخدام مؤشر جاكارد أو مقياس مماثل.

2. تعيين التجمعات الثنائية من مجموعة واحدة إلى أخرى بطريقة واحد لواحد لتعظيم مجموع تشابهاتها. يتم تنفيذ هذه الخطوة باستخدام scipy.optimize.linear_sum_assignment، والذي يستخدم خوارزمية Jonker-Volgenant معدلة.

3. يتم تقسيم مجموع التشابهات على حجم المجموعة الأكبر.

تحدث درجة التوافق الدنيا، 0، عندما تكون جميع أزواج التجمعات الثنائية مختلفة تمامًا. تحدث الدرجة القصوى، 1، عندما تكون المجموعتان متطابقتين.

المراجع

* Hochreiter وBodenhofer et. al.، 2010. FABIA: تحليل العوامل للحصول على التجمعات الثنائية.